Math.randomString=function(n){for(var text="",possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;n>i;i++)text+=possible.charAt(Math.floor(Math.random()*possible.length));return text},String.prototype.getCss=function(){for(var css={},style=this.valueOf().split(";"),i=0;i<style.length;i++)if(style[i]=jQuery.trim(style[i]),style[i]){var s=style[i].split(":");css[jQuery.trim(s[0])]=jQuery.trim(s[1])}return css},String.prototype.trim=function(){return this.replace(/^\s+|\s+jQuery/g,"")},String.prototype.toCamel=function(){return this.replace(/(\-[a-z])/g,function(jQuery1){return jQuery1.toUpperCase().replace("-","")})},String.prototype.toDash=function(){return this.replace(/([A-Z])/g,function(jQuery1){return"-"+jQuery1.toLowerCase()})},String.prototype.toUnderscore=function(){return this.replace(/([A-Z])/g,function(jQuery1){return"_"+jQuery1.toLowerCase()})},Number.prototype.isBetween=function(num1,num2,including){if(including){if(this.valueOf()<=num2&&this.valueOf()>=num1)return!0}else if(this.valueOf()<num2&&this.valueOf()>num1)return!0;return!1},jQuery.fn.insertAt=function(i,selector){var object=selector;if("string"==typeof selector&&(object=jQuery(selector)),i=Math.min(object.children().length,i),0==i)return object.prepend(this),this;var oldIndex=this.data("index");return this.attr("data-index",i),object.find(">*:nth-child("+i+")").after(this),object.children().each(function(index,el){var jQueryel=jQuery(el);i>oldIndex&&index>oldIndex&&i>=index?jQueryel.attr("data-index",parseInt(jQueryel.data("data-index"),10)-1):oldIndex>=i&&index>i&&oldIndex>=index&&jQueryel.attr("data-index",parseInt(jQueryel.attr("data-index"),10)+1)}),this},jQuery.fn.disableSelection=function(){return this.attr("unselectable","on").css("user-select","none").on("selectstart",!1)},jQuery.fn.enableSelection=function(){return this.removeAttr("unselectable").css("user-select","initial").off("selectstart")},jQuery(function(){var LobiPanel=function(jQueryel,options){this.jQueryel=null,this.jQueryoptions={},this.hasRandomId=!1,this.storage=null;var jQueryheading,jQuerybody,innerId,storagePrefix="lobipanel_",me=this,_processInput=function(options){options||(options={});var opts=_getOptionsFromAttributes();options=jQuery.extend({},jQuery.fn.lobiPanel.DEFAULTS,me.storage,options,opts);for(var objects=["unpin","reload","expand","minimize","close","editTitle"],i=0;i<objects.length;i++){var prop=objects[i];"object"==typeof options[prop]&&(options[prop]=jQuery.extend({},jQuery.fn.lobiPanel.DEFAULTS[prop],options[prop],opts[prop]))}return options},_init=function(){me.jQueryel.addClass("lobipanel"),jQueryheading.append(_generateControls());var parent=me.jQueryel.parent();_appendInnerIdToParent(parent,innerId),_enableSorting(),_adjustForScreenSize(),_onToggleIconsBtnClick(),_enableResponsiveness(),_setBodyHeight(),me.jQueryoptions.autoload&&me.load();var maxWidth="calc(100% - "+jQueryheading.find(".dropdown-menu").children().length*jQueryheading.find(".dropdown-menu li").first().outerWidth()+"px)";jQueryheading.find(".panel-title").css("max-width",maxWidth),_triggerEvent("init")},_generateControls=function(){var dropdown=_generateDropdown(),menu=dropdown.find(".dropdown-menu");return me.jQueryoptions.editTitle!==!1&&menu.append(_generateEditTitle()),me.jQueryoptions.unpin!==!1&&menu.append(_generateUnpin()),me.jQueryoptions.reload!==!1&&menu.append(_generateReload()),me.jQueryoptions.minimize!==!1&&menu.append(_generateMinimize()),me.jQueryoptions.expand!==!1&&menu.append(_generateExpand()),me.jQueryoptions.close!==!1&&menu.append(_generateClose()),menu.find(">li>a").on("click",function(ev){ev.preventDefault(),ev.stopPropagation()}),dropdown},_generateDropdown=function(){return jQuery('<div class="dropdown"></div>').append('<ul class="dropdown-menu dropdown-menu-right"></ul>').append('<div class="dropdown-toggle" data-toggle="dropdown"><span class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+me.jQueryoptions.toggleIcon+'"></div>')},_generateEditTitle=function(){var options=me.jQueryoptions.editTitle,control=jQuery('<a data-func="editTitle"></a>');return control.append('<i class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+options.icon+'"></i>'),options.tooltip&&"string"==typeof options.tooltip&&(control.append('<span class="control-title">'+options.tooltip+"</span>"),control.attr("data-tooltip",options.tooltip)),_onEditTitleClick(control),jQuery("<li></li>").append(control)},_onEditTitleClick=function(control){control.on("mousedown",function(ev){ev.stopPropagation()}),control.on("click",function(ev){ev.stopPropagation(),jQueryheading.find('[data-func="editTitle"]').tooltip("hide"),me.isTitleEditing()?me.finishTitleEditing():me.startTitleEditing()})},_generateUnpin=function(){var options=me.jQueryoptions.unpin,control=jQuery('<a data-func="unpin"></a>');return control.append('<i class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+options.icon+'"></i>'),options.tooltip&&"string"==typeof options.tooltip&&(control.append('<span class="control-title">'+options.tooltip+"</span>"),control.attr("data-tooltip",options.tooltip)),_onUnpinClick(control),jQuery("<li></li>").append(control)},_onUnpinClick=function(control){control.on("mousedown",function(ev){ev.stopPropagation()}),control.on("click",function(){me.togglePin()})},_generateReload=function(){var options=me.jQueryoptions.reload,control=jQuery('<a data-func="reload"></a>');return control.append('<i class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+options.icon+'"></i>'),options.tooltip&&"string"==typeof options.tooltip&&(control.append('<span class="control-title">'+options.tooltip+"</span>"),control.attr("data-tooltip",options.tooltip)),_onReloadClick(control),jQuery("<li></li>").append(control)},_onReloadClick=function(control){control.on("mousedown",function(ev){ev.stopPropagation()}),control.on("click",function(){me.load({callback:function(){control.tooltip("hide")}})})},_generateMinimize=function(){var options=me.jQueryoptions.minimize,control=jQuery('<a data-func="minimize"></a>');return control.append('<i class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+options.icon+'"></i>'),options.tooltip&&"string"==typeof options.tooltip&&(control.append('<span class="control-title">'+options.tooltip+"</span>"),control.attr("data-tooltip",options.tooltip)),_onMinimizeClick(control),jQuery("<li></li>").append(control)},_onMinimizeClick=function(control){control.on("mousedown",function(ev){ev.stopPropagation()}),control.on("click",function(ev){ev.stopPropagation(),me.toggleMinimize()})},_generateExpand=function(){var options=me.jQueryoptions.expand,control=jQuery('<a data-func="expand"></a>');return control.append('<i class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+options.icon+'"></i>'),options.tooltip&&"string"==typeof options.tooltip&&(control.append('<span class="control-title">'+options.tooltip+"</span>"),control.attr("data-tooltip",options.tooltip)),_onExpandClick(control),jQuery("<li></li>").append(control)},_onExpandClick=function(control){control.on("mousedown",function(ev){ev.stopPropagation()}),control.on("click",function(ev){ev.stopPropagation(),me.toggleSize()})},_generateClose=function(){var options=me.jQueryoptions.close,control=jQuery('<a data-func="close"></a>');return control.append('<i class="'+LobiPanel.PRIVATE_OPTIONS.iconClass+" "+options.icon+'"></i>'),options.tooltip&&"string"==typeof options.tooltip&&(control.append('<span class="control-title">'+options.tooltip+"</span>"),control.attr("data-tooltip",options.tooltip)),_onCloseClick(control),jQuery("<li></li>").append(control)},_onCloseClick=function(control){control.on("mousedown",function(ev){ev.stopPropagation()}),control.on("click",function(ev){ev.stopPropagation(),control.tooltip("hide"),me.close()})},_getMaxZIndex=function(){var style,max,cur,panels=jQuery(".lobipanel.panel-unpin:not(.panel-minimized.panel-expanded)");if(0===panels.length)return{id:"","z-index":LobiPanel.PRIVATE_OPTIONS.initialZIndex};style=jQuery(panels[0]).attr("style");var id=jQuery(panels[0]).data("inner-id");max=style?style.getCss()["z-index"]:LobiPanel.PRIVATE_OPTIONS.initialZIndex;for(var i=1;i<panels.length;i++)style=jQuery(panels[i]).attr("style"),cur=style?style.getCss()["z-index"]:0,cur>max&&(id=jQuery(panels[i]).data("inner-id"),max=cur);return{id:id,"z-index":parseInt(max,10)}},_onPanelClick=function(){me.jQueryel.on("mousedown.lobiPanel",function(){return me.isPinned()||me.isMinimized()||me.isOnFullScreen()?!1:void me.bringToFront()})},_offPanelClick=function(){me.jQueryel.off("mousedown.lobiPanel")},_changeClassOfControl=function(el){el=jQuery(el);var opts=me.jQueryoptions[el.attr("data-func")];opts.icon&&el.find("."+LobiPanel.PRIVATE_OPTIONS.iconClass).toggleClass(opts.icon).toggleClass(opts.icon2)},_getFooterForMinimizedPanels=function(){var minimizedCtr=jQuery("."+LobiPanel.PRIVATE_OPTIONS.toolbarClass);return 0===minimizedCtr.length&&(minimizedCtr=jQuery('<div class="'+LobiPanel.PRIVATE_OPTIONS.toolbarClass+'"></div>'),jQuery("body").append(minimizedCtr)),minimizedCtr},_expandOnHeaderClick=function(){jQueryheading.on("click.lobiPanel",function(){me.maximize(),me.bringToFront()})},_removeExpandOnHeaderClick=function(){jQueryheading.off("click.lobiPanel")},_getAvailableWidth=function(calcWidth){return me.jQueryoptions.maxWidth&&(calcWidth=Math.min(calcWidth,me.jQueryoptions.maxWidth)),me.jQueryoptions.minWidth&&(calcWidth=Math.max(calcWidth,me.jQueryoptions.minWidth)),calcWidth},_getAvailableHeight=function(calcHeight){return me.jQueryoptions.maxHeight&&(calcHeight=Math.min(calcHeight,me.jQueryoptions.maxHeight)),me.jQueryoptions.minHeight&&(calcHeight=Math.max(calcHeight,me.jQueryoptions.minHeight)),calcHeight},_calculateBodyHeight=function(h){return h-jQueryheading.outerHeight()-me.jQueryel.find(".panel-footer").outerHeight()},_calculateBodyWidth=function(w){return w-2},_appendInnerIdToParent=function(parent,innerId){if(void 0===parent.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr))parent.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr,innerId);else{if(parent.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr).indexOf(innerId)>-1)return;var innerIds=parent.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr);parent.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr,innerIds+" "+innerId)}me.jQueryel.attr("data-index",me.jQueryel.index())},_insertInParent=function(){var parent=jQuery("["+LobiPanel.PRIVATE_OPTIONS.parentAttr+"~="+innerId+"]");me.jQueryel.insertAt(me.jQueryel.attr("data-index"),parent)},_generateWindow8Spinner=function(){var template=['<div class="spinner spinner-windows8">','<div class="wBall">','<div class="wInnerBall">',"</div>","</div>",'<div class="wBall">','<div class="wInnerBall">',"</div>","</div>",'<div class="wBall">','<div class="wInnerBall">',"</div>","</div>",'<div class="wBall">','<div class="wInnerBall">',"</div>","</div>",'<div class="wBall">','<div class="wInnerBall">',"</div>","</div>","</div>"].join("");return jQuery('<div class="spinner-wrapper">'+template+"</div>")},_enableSorting=function(){var parent=me.jQueryel.parent();parent.hasClass("ui-sortable")&&parent.sortable("destroy"),me.jQueryoptions.sortable?(me.jQueryel.addClass("lobipanel-sortable"),parent.addClass("lobipanel-parent-sortable")):me.jQueryel.removeClass("lobipanel-sortable"),parent.sortable({connectWith:".lobipanel-parent-sortable",items:".lobipanel-sortable",handle:".panel-heading",cursor:"move",placeholder:"lobipanel-placeholder",forcePlaceholderSize:!0,opacity:.7,revert:300,update:function(event,ui){var innerId=ui.item.data("inner-id");_removeInnerIdFromParent(innerId),_appendInnerIdToParent(ui.item.parent(),innerId),_updateDataIndices(ui.item),_triggerEvent("dragged")}})},_disableSorting=function(){var parent=me.jQueryel.parent();parent.hasClass("ui-sortable")&&parent.sortable("destroy")},_updateDataIndices=function(panel){var items=panel.parent().find("> *");items.each(function(index,el){jQuery(el).attr("data-index",index)})},_removeInnerIdFromParent=function(innerId){var parent=jQuery("["+LobiPanel.PRIVATE_OPTIONS.parentAttr+"~="+innerId+"]"),innerIds=parent.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr).replace(innerId,"").trim().replace(/\s{2,}/g," ");parent.attr(LobiPanel.PRIVATE_OPTIONS.parentAttr,innerIds)},_onToggleIconsBtnClick=function(){jQueryheading.find(".toggle-controls").on("click.lobiPanel",function(){me.jQueryel.toggleClass("controls-expanded")})},_adjustForScreenSize=function(){me.disableTooltips(),jQuery(window).width()>768&&me.jQueryoptions.tooltips&&me.enableTooltips(),me.isOnFullScreen()&&jQuerybody.css({width:_calculateBodyWidth(me.jQueryel.width()),height:_calculateBodyHeight(me.jQueryel.height())})},_enableResponsiveness=function(){jQuery(window).on("resize.lobiPanel",function(){_adjustForScreenSize()})},_setBodyHeight=function(){"auto"!==me.jQueryoptions.bodyHeight&&jQuerybody.css({height:me.jQueryoptions.bodyHeight,overflow:"auto"})},_getOptionsFromAttributes=function(){var jQueryel=me.jQueryel,options={};for(var key in jQuery.fn.lobiPanel.DEFAULTS){var k=key.toDash(),val=jQueryel.data(k);void 0!==val&&(options[key]="object"!=typeof jQuery.fn.lobiPanel.DEFAULTS[key]?val:eval("("+val+")"))}return options},_saveState=function(state){!me.hasRandomId&&me.jQueryoptions.stateful&&(me.storage.state=state,_saveLocalStorage(me.storage))},_saveLocalStorage=function(storage){localStorage.setItem(storagePrefix+innerId,JSON.stringify(storage))},_applyState=function(state){switch(state){case"unpinned":me.unpin();break;case"minimized":me.unpin(),me.minimize();break;case"collapsed":me.minimize();break;case"fullscreen":me.toFullScreen()}},_applyIndex=function(index){null!==index&&me.jQueryel.insertAt(index,me.jQueryel.parent())},_triggerEvent=function(eventType){var args=Array.prototype.slice.call(arguments,1);args.unshift(me),me.jQueryel.trigger(eventType+".lobiPanel",args)};this.isPanelInit=function(){return me.jQueryel.hasClass("lobipanel")&&me.jQueryel.data("inner-id")},this.isPinned=function(){return!me.jQueryel.hasClass("panel-unpin")},this.pin=function(){return _triggerEvent("beforePin"),jQueryheading.find('[data-func="unpin"]').tooltip("hide"),me.disableResize(),me.disableDrag(),_enableSorting(),_offPanelClick(),me.jQueryel.removeClass("panel-unpin").attr("old-style",me.jQueryel.attr("style")).removeAttr("style").css("position","relative"),jQuerybody.css({width:"",height:""}),_setBodyHeight(),_insertInParent(),_saveState("pinned"),_triggerEvent("onPin"),me},this.unpin=function(){if(_triggerEvent("beforeUnpin"),me.jQueryel.hasClass("panel-collapsed"))return me;if(_disableSorting(),jQueryheading.find('[data-func="unpin"]').tooltip("hide"),me.jQueryel.attr("old-style"))me.jQueryel.attr("style",me.jQueryel.attr("old-style"));else{var width=me.jQueryel.width(),height=me.jQueryel.height(),left=Math.max(0,(jQuery(window).width()-me.jQueryel.outerWidth())/2),top=Math.max(0,(jQuery(window).height()-me.jQueryel.outerHeight())/2);me.jQueryel.css({left:left,top:top,width:width,height:height})}var res=_getMaxZIndex();me.jQueryel.css("z-index",res["z-index"]+1),_onPanelClick(),me.jQueryel.addClass("panel-unpin"),jQuery("body").append(me.jQueryel);var panelWidth=_getAvailableWidth(me.jQueryel.width()),panelHeight=_getAvailableHeight(me.jQueryel.height());me.jQueryel.css({position:"fixed",width:panelWidth,height:panelHeight});var bHeight=_calculateBodyHeight(panelHeight),bWidth=_calculateBodyWidth(panelWidth);return jQuerybody.css({width:bWidth,height:bHeight}),me.jQueryoptions.draggable&&me.enableDrag(),"none"!==me.jQueryoptions.resize&&me.enableResize(),_saveState("unpinned"),_triggerEvent("onUnpin"),me},this.togglePin=function(){return this.isPinned()?this.unpin():this.pin(),me},this.isMinimized=function(){return me.jQueryel.hasClass("panel-minimized")||me.jQueryel.hasClass("panel-collapsed")},this.minimize=function(){if(_triggerEvent("beforeMinimize"),me.isMinimized())return me;if(me.isPinned())jQuerybody.slideUp(),me.jQueryel.find(".panel-footer").slideUp(),me.jQueryel.addClass("panel-collapsed"),_saveState("collapsed"),_changeClassOfControl(jQueryheading.find('[data-func="minimize"]'));else{me.disableTooltips(),jQueryheading.find('[data-func="minimize"]').tooltip("hide");var left,top,footer=_getFooterForMinimizedPanels(),children=footer.find(">*");if(top=footer.offset().top,0===children.length)left=footer.offset().left;else{var ch=jQuery(children[children.length-1]);left=ch.offset().left+ch.width()}me.jQueryel.hasClass("panel-expanded")||me.jQueryel.attr("old-style",me.jQueryel.attr("style")),me.jQueryel.animate({left:left,top:top,width:200,height:footer.height()},100,function(){me.jQueryel.hasClass("panel-expanded")&&(me.jQueryel.removeClass("panel-expanded"),me.jQueryel.find(".panel-heading [data-func=expand] ."+LobiPanel.PRIVATE_OPTIONS.iconClass).removeClass(me.jQueryoptions.expand.icon2).addClass(me.jQueryoptions.expand.icon)),me.jQueryel.addClass("panel-minimized"),me.jQueryel.removeAttr("style"),me.disableDrag(),me.disableResize(),_expandOnHeaderClick(),footer.append(me.jQueryel),jQuery("body").addClass("lobipanel-minimized");var maxWidth="calc(100% - "+jQueryheading.find(".dropdown-menu li>a:visible").length*jQueryheading.find(".dropdown-menu li>a:visible").first().outerWidth()+"px)";jQueryheading.find(".panel-title").css("max-width",maxWidth),_saveState("minimized"),_triggerEvent("onMinimize")})}return me},this.maximize=function(){if(_triggerEvent("beforeMaximize"),!me.isMinimized())return me;if(me.isPinned())jQuerybody.slideDown(),me.jQueryel.find(".panel-footer").slideDown(),me.jQueryel.removeClass("panel-collapsed"),_saveState("pinned"),_changeClassOfControl(jQueryheading.find('[data-func="minimize"]'));else{me.enableTooltips();var css=me.jQueryel.attr("old-style").getCss();me.jQueryel.css({position:css.position||"fixed","z-index":css["z-index"],left:me.jQueryel.offset().left,top:me.jQueryel.offset().top,width:me.jQueryel.width(),height:me.jQueryel.height()}),jQuery("body").append(me.jQueryel),delete css.position,delete css["z-index"],me.jQueryel.animate(css,100,function(){me.jQueryel.css("position",""),me.jQueryel.removeClass("panel-minimized"),me.jQueryel.removeAttr("old-style"),me.jQueryoptions.draggable&&me.enableDrag(),me.enableResize(),_removeExpandOnHeaderClick();var footer=_getFooterForMinimizedPanels();0===footer.children().length&&footer.remove(),jQuery("body").removeClass("lobipanel-minimized").addClass("lobipanel-minimized");var maxWidth="calc(100% - "+jQueryheading.find(".dropdown-menu li").length*jQueryheading.find(".dropdown-menu li").first().outerWidth()+"px)";jQueryheading.find(".panel-title").css("max-width",maxWidth),_saveState("unpinned"),_triggerEvent("onMaximize")})}return me},this.toggleMinimize=function(){return me.isMinimized()?me.maximize():me.minimize(),me},this.isOnFullScreen=function(){return me.jQueryel.hasClass("panel-expanded")},this.toFullScreen=function(){if(_triggerEvent("beforeFullScreen"),me.jQueryel.hasClass("panel-collapsed"))return me;_changeClassOfControl(jQueryheading.find('[data-func="expand"]')),jQueryheading.find('[data-func="expand"]').tooltip("hide");var res=_getMaxZIndex();if(me.isPinned()||me.isMinimized()){me.enableTooltips(),me.jQueryel.css({position:"fixed","z-index":res["z-index"]+1,left:me.jQueryel.offset().left,top:me.jQueryel.offset().top-jQuery(window).scrollTop(),width:me.jQueryel.width(),height:me.jQueryel.height()}),jQuery("body").append(me.jQueryel);var footer=_getFooterForMinimizedPanels();0===footer.children().length&&footer.remove()}else jQuerybody.css({width:"",height:""}),_setBodyHeight();me.isMinimized()?(me.jQueryel.removeClass("panel-minimized"),_removeExpandOnHeaderClick()):(me.jQueryel.attr("old-style",me.jQueryel.attr("style")),me.disableResize());var toolbar=jQuery("."+LobiPanel.PRIVATE_OPTIONS.toolbarClass),toolbarHeight=toolbar.outerHeight()||0;return me.jQueryel.animate({width:jQuery(window).width(),height:jQuery(window).height()-toolbarHeight,left:0,top:0},me.jQueryoptions.expandAnimation,function(){me.jQueryel.css({width:"",height:"",right:0,bottom:toolbarHeight}),me.jQueryel.addClass("panel-expanded"),jQuery("body").css("overflow","hidden"),jQuerybody.css({width:_calculateBodyWidth(me.jQueryel.width()),height:_calculateBodyHeight(me.jQueryel.height())}),me.disableDrag(),me.isPinned()&&_disableSorting(),_saveState("fullscreen"),_triggerEvent("onFullScreen")}),me},this.toSmallSize=function(){_triggerEvent("beforeSmallSize"),_changeClassOfControl(jQueryheading.find('[data-func="expand"]')),jQueryheading.find('[data-func="expand"]').tooltip("hide");var css=me.jQueryel.attr("old-style").getCss();return me.jQueryel.animate({left:css.left,top:css.top,width:css.width,height:css.height,right:css.right,bottom:css.bottom},me.jQueryoptions.collapseAnimation,function(){me.jQueryel.removeAttr("old-style"),me.jQueryel.hasClass("panel-unpin")?(me.jQueryoptions.draggable&&me.enableDrag(),me.enableResize()):(me.jQueryel.removeAttr("style"),_insertInParent(),_enableSorting()),me.jQueryel.removeClass("panel-expanded"),jQuery("body").css("overflow","auto");var bWidth="",bHeight="";me.isPinned()?"auto"!==me.jQueryoptions.bodyHeight&&(bHeight=me.jQueryoptions.bodyHeight,_saveState("pinned")):(bWidth=_calculateBodyWidth(me.getWidth()),bHeight=_calculateBodyHeight(me.getHeight()),_saveState("unpinned")),jQuerybody.css({width:bWidth,height:bHeight}),_triggerEvent("onSmallSize")}),me},this.toggleSize=function(){return me.isOnFullScreen()?me.toSmallSize():me.toFullScreen(),me},this.close=function(){return _triggerEvent("beforeClose"),me.jQueryel.hide(100,function(){me.isOnFullScreen()&&jQuery("body").css("overflow","auto"),me.jQueryel.remove();var footer=_getFooterForMinimizedPanels();0===footer.children().length&&footer.remove(),_triggerEvent("onClose")}),me},this.setPosition=function(left,top){return me.isPinned()?me:(me.jQueryel.animate({left:left,top:top},100),me)},this.setWidth=function(w){if(me.isPinned())return me;var bWidth=_calculateBodyWidth(w);return me.jQueryel.animate({width:w},100),jQuerybody.animate({width:bWidth},100),me},this.setHeight=function(h){if(me.isPinned())return me;var bHeight=_calculateBodyHeight(h);return me.jQueryel.animate({height:h},100),jQuerybody.animate({height:bHeight},100),me},this.setSize=function(w,h){if(me.isPinned())return me;var bHeight=_calculateBodyHeight(h),bWidth=_calculateBodyWidth(w);return me.jQueryel.animate({height:h,width:w},100),jQuerybody.animate({height:bHeight,width:bWidth},100),me},this.getPosition=function(){var offset=me.jQueryel.offset();return{x:offset.left,y:offset.top}},this.getWidth=function(){return me.jQueryel.width()},this.getHeight=function(){return me.jQueryel.height()},this.bringToFront=function(){_triggerEvent("beforeToFront");var res=_getMaxZIndex();return res.id===me.jQueryel.data("inner-id")?me:(me.jQueryel.css("z-index",res["z-index"]+1),_triggerEvent("onToFront"),me)},this.enableDrag=function(){return me.jQueryel.draggable({handle:".panel-heading"}),me},this.disableDrag=function(){return me.jQueryel.hasClass("ui-draggable")&&me.jQueryel.draggable("destroy"),me},this.enableResize=function(){var handles=!1;return"vertical"===me.jQueryoptions.resize?handles="n, s":"horizontal"===me.jQueryoptions.resize?handles="e, w":"both"===me.jQueryoptions.resize&&(handles="all"),handles?(me.jQueryel.resizable({minWidth:me.jQueryoptions.minWidth,maxWidth:me.jQueryoptions.maxWidth,minHeight:me.jQueryoptions.minHeight,maxHeight:me.jQueryoptions.maxHeight,handles:handles,start:function(){me.jQueryel.disableSelection(),_triggerEvent("resizeStart")},stop:function(){me.jQueryel.enableSelection(),_triggerEvent("resizeStop")},resize:function(){var bHeight=_calculateBodyHeight(me.jQueryel.height()),bWidth=_calculateBodyWidth(me.jQueryel.width());jQuerybody.css({width:bWidth,height:bHeight}),_triggerEvent("onResize")}}),me):void 0},this.disableResize=function(){return me.jQueryel.hasClass("ui-resizable")&&me.jQueryel.resizable("destroy"),me},this.startLoading=function(){var spinner=_generateWindow8Spinner();me.jQueryel.append(spinner);var sp=spinner.find(".spinner");return sp.css("margin-top",50),me},this.stopLoading=function(){return me.jQueryel.find(".spinner-wrapper").remove(),me},this.setLoadUrl=function(url){return me.jQueryoptions.loadUrl=url,me},this.load=function(params){params=params||{},"string"==typeof params&&(params={url:params});var url=params.url||me.jQueryoptions.loadUrl,data=params.data||{},callback=params.callback||null;return url?(_triggerEvent("beforeLoad"),me.startLoading(),jQuerybody.load(url,data,function(result,status,xhr){callback&&"function"==typeof callback&&callback(result,status,xhr),me.stopLoading(),_triggerEvent("loaded",result,status,xhr)}),me):me},this.destroy=function(){return me.disableDrag(),me.disableResize(),me.jQueryoptions.sortable=!1,_enableSorting(),_removeInnerIdFromParent(innerId),me.jQueryel.removeClass("lobipanel").removeAttr("data-inner-id").removeAttr("data-index").removeData("lobiPanel"),jQueryheading.find(".dropdown").remove(),me.jQueryel},this.startTitleEditing=function(){var title=jQueryheading.find(".panel-title").text().trim(),input=jQuery('<input value="'+title+'"/>');return input.on("keydown",function(ev){13===ev.which?me.finishTitleEditing():27===ev.which&&me.cancelTitleEditing()}),jQueryheading.find(".panel-title").data("old-title",title).html("").append(input),input[0].focus(),input[0].select(),_changeClassOfControl(jQueryheading.find('[data-func="editTitle"]')),me},this.isTitleEditing=function(){return jQueryheading.find(".panel-title input").length>0},this.cancelTitleEditing=function(){var title=jQueryheading.find(".panel-title");return title.html(title.data("old-title")).find("input").remove(),_changeClassOfControl(jQueryheading.find('[data-func="editTitle"]')),me},this.finishTitleEditing=function(){var input=jQueryheading.find("input");return jQueryheading.find(".panel-title").html(input.val()),input.remove(),_changeClassOfControl(jQueryheading.find('[data-func="editTitle"]')),me},this.enableTooltips=function(){if(jQuery(window).width()<768)return me;var controls=jQueryheading.find(".dropdown-menu>li>a");return controls.each(function(index,el){var jQueryel=jQuery(el);jQueryel.attr("data-toggle","tooltip").attr("data-title",jQueryel.data("tooltip")).attr("data-placement","bottom")}),controls.each(function(ind,el){jQuery(el).tooltip({container:"body",template:'<div class="tooltip lobipanel-tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'})}),me},this.disableTooltips=function(){return jQueryheading.find(".dropdown-menu>li>a").tooltip("destroy"),me},this.jQueryel=jQueryel,me.jQueryel.data("inner-id")||(me.hasRandomId=!0,me.jQueryel.attr("data-inner-id",Math.randomString(10))),innerId=me.jQueryel.data("inner-id"),me.hasRandomId||(me.storage=localStorage.getItem(storagePrefix+innerId),me.storage=JSON.parse(me.storage)||{}),this.jQueryoptions=_processInput(options),jQueryheading=this.jQueryel.find(">.panel-heading"),jQuerybody=this.jQueryel.find(">.panel-body"),_init(),_applyState(me.jQueryoptions.state),_applyIndex(me.jQueryoptions.initialIndex)};jQuery.fn.lobiPanel=function(option){var args=arguments,ret=null;return this.each(function(){var jQuerythis=jQuery(this),data=jQuerythis.data("lobiPanel"),options="object"==typeof option&&option;data||jQuerythis.data("lobiPanel",data=new LobiPanel(jQuerythis,options)),"string"==typeof option&&(args=Array.prototype.slice.call(args,1),ret=data[option].apply(data,args))}),ret},LobiPanel.PRIVATE_OPTIONS={parentAttr:"data-lobipanel-child-inner-id",toolbarClass:"lobipanel-minimized-toolbar",initialZIndex:1e4,iconClass:"panel-control-icon"},jQuery.fn.lobiPanel.DEFAULTS={draggable:!0,sortable:!1,connectWith:".ui-sortable",resize:"both",minWidth:200,minHeight:100,maxWidth:1200,maxHeight:700,loadUrl:"",autoload:!0,bodyHeight:"auto",tooltips:!0,toggleIcon:"glyphicon glyphicon-cog",expandAnimation:100,collapseAnimation:100,state:"pinned",initialIndex:null,stateful:!1,unpin:{icon:"glyphicon glyphicon-move",tooltip:"Unpin"},reload:{icon:"glyphicon glyphicon-refresh",tooltip:"Reload"},minimize:{icon:"glyphicon glyphicon-minus",icon2:"glyphicon glyphicon-plus",tooltip:"Minimize"},expand:{icon:"glyphicon glyphicon-resize-full",icon2:"glyphicon glyphicon-resize-small",tooltip:"Fullscreen"},close:{icon:"glyphicon glyphicon-remove",tooltip:"Close"},editTitle:{icon:"glyphicon glyphicon-pencil",icon2:"glyphicon glyphicon-floppy-disk",tooltip:"Edit title"}},jQuery(".lobipanel").lobiPanel()});